<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>d3关系图</title>
  <link rel="stylesheet" href="/css/index.css">
  <script src="/bower_components/d3/d3.js"></script>
 <script src="/bower_components/d3-tip/index.js"></script>


</head>
<body>
</body>



<script>
     var links,nodes,id;
     var temp=2;
    function callbackLinks(data){

        links=data.data;
        if(temp==2){
          temp--;
        }
        else if(temp==1){
          forcemap();
        }


    }
    function callbackNodes(data){
        nodes=data.data;

        if(temp==2){
          temp--;
        }
        else if(temp==1){
          forcemap();
        }

     }
     function displayperson(){

     }
   (function(){





   });

     function  jsonp(url){
      var href=window.location.href;
      console.log(href);
      var reg = new RegExp("(^|&|\\?)id=([^&]*)(&|$)"), r;
  if (r=href.match(reg))
  id=unescape(r[2]);
      else{
        id="";
      }

      console.log(id);
      var script = document.createElement("script");
        script.type = "text/javascript";
        var src =  url+"&id="+id;
        script.src = src;
        document.body.appendChild(script);

     }


     jsonp('http://10.18.218.115:2100/asyn/findRelationInfoById.vm?callback=callbackLinks');

      jsonp('http://10.18.218.115:2100/asyn/findNodeInfoByIdWithRelated.vm?callback=callbackNodes');


    </script>
<script src="/src/forceMap.js"></script>
<!--<script src="/src/index.js"></script>-->

<script >
  function forcemap(){
    var options = {
    nodes: nodes,
    links: links,
};

ForceMap(options);
  }

</script>

</html>
